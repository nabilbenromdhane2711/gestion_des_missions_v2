// Fonction pour exporter les missions archivées en CSV
document.getElementById('exportButton').addEventListener('click', function() {
    const archivedRecords = records.filter(record => record.archived);
    
    if (archivedRecords.length === 0) {
        alert("Aucune mission archivée à exporter.");
        return;
    }
    
    // Créer le contenu CSV
    let csvContent = "Nom collaborateur,Type intervention,Type mission,Détail mission,Description,Priorité,Date\n";
    
    archivedRecords.forEach(record => {
        csvContent += `"${record.userName}",`;
        csvContent += `"${record.interventionType === 'remote' ? 'À distance' : 
                      record.interventionType === 'onsite' ? 'Sur place' : 'Les deux'}",`;
        csvContent += `"${record.missionTypeLabel}",`;
        csvContent += `"${record.missionDetail}",`;
        csvContent += `"${record.description.replace(/"/g, '""')}",`;
        csvContent += `"${record.priority}",`;
        csvContent += `"${record.date}"\n`;
    });
    
    // Créer un lien de téléchargement
    const encodedUri = encodeURI("data:text/csv;charset=utf-8," + csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", `missions_archivees_${new Date().toISOString().slice(0,10)}.csv`);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
});
